<header class="navbar">
    <div class="navbar-brand">
        <a href="/" class="logo" preload="mouseenter">AIç”Ÿæˆç¤¾åŒº</a>
    </div>

    <nav class="navbar-menu">
        <a href="/categories" class="nav-link" preload="mouseenter">åˆ†ç±»</a>
        {% if user %}
            {% if user.user_role == 'asker' %}
            <a href="/posts/create" class="nav-link btn-primary" preload="mouseenter">å‘å¸ƒæ±‚åŠ©</a>
            {% elif user.user_role == 'solver' %}
            <a href="/posts" class="nav-link btn-primary" preload="mouseenter">æµè§ˆè®¢å•</a>
            {% elif user.user_role == 'both' %}
            <a href="/posts/create" class="nav-link btn-secondary" preload="mouseenter">å‘å¸ƒæ±‚åŠ©</a>
            <a href="/posts" class="nav-link btn-primary" preload="mouseenter">æµè§ˆè®¢å•</a>
            {% endif %}

            <!-- æ¶ˆæ¯å›¾æ ‡ -->
            <a href="/messages" class="nav-link message-icon-link"
               hx-get="/messages/unread-count"
               hx-trigger="load, every 30s"
               hx-swap="innerHTML"
               preload="mouseenter">
                <span class="icon">ğŸ””</span>
            </a>

            <div class="dropdown user-dropdown">
                <button class="dropdown-toggle nav-link">{{ user.nickname }}</button>
                <div class="dropdown-menu">
                    <a href="/users/profile" class="dropdown-item" preload="mouseenter">ä¸ªäººèµ„æ–™</a>
                    {% if user.user_role != 'solver' %}
                    <a href="/users/my-posts" class="dropdown-item" preload="mouseenter">æˆ‘çš„æ±‚åŠ©å•</a>
                    {% endif %}
                    {% if user.user_role in ['solver', 'both'] %}
                    <a href="/users/my-orders" class="dropdown-item" preload="mouseenter">æˆ‘æ¥çš„å•å­</a>
                    {% endif %}
                    <hr>
                    <form action="/auth/logout" method="post">
                        <button type="submit" class="dropdown-item">é€€å‡ºç™»å½•</button>
                    </form>
                </div>
            </div>
        {% else %}
            <a href="/auth/login" class="nav-link" preload="mouseenter">ç™»å½•</a>
            <a href="/auth/register" class="nav-link btn-primary" preload="mouseenter">æ³¨å†Œ</a>
        {% endif %}
    </nav>
</header>

<style>
.user-dropdown .dropdown-toggle {
    color: var(--text-color);
    font-size: 1rem;
}

.user-dropdown .dropdown-item {
    font-size: 1rem;
}

/* æ¶ˆæ¯å›¾æ ‡æ ·å¼ */
.message-icon-link {
    position: relative;
    display: flex;
    align-items: center;
    padding: 0.5rem;
}

.message-icon-link .icon {
    font-size: 1.25rem;
}

.message-icon-link .badge {
    position: absolute;
    top: 0;
    right: -2px;
    background: var(--danger-color);
    color: white;
    font-size: 0.7rem;
    font-weight: 600;
    min-width: 18px;
    height: 18px;
    border-radius: 9px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 4px;
}
</style>
