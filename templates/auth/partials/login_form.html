{% if error %}
<div class="alert alert-error login-error">
    <span class="error-icon">⚠️</span>
    <span class="error-text">{{ error }}</span>
</div>
{% endif %}

<!-- 微信登录（主推） -->
<button type="button" class="btn-wechat btn-full btn-wechat-primary" onclick="wechatLogin()">
    <svg class="wechat-icon" viewBox="0 0 24 24" width="20" height="20">
        <path fill="currentColor" d="M9.5,4C5.36,4 2,6.69 2,10C2,11.89 3.08,13.56 4.78,14.66L4,17L6.5,15.5C7.39,15.81 8.37,16 9.41,16C9.15,15.37 9,14.7 9,14C9,10.69 12.13,8 16,8C16.19,8 16.38,8 16.56,8.03C15.54,5.69 12.78,4 9.5,4M6.5,6.5A1,1 0 0,1 7.5,7.5A1,1 0 0,1 6.5,8.5A1,1 0 0,1 5.5,7.5A1,1 0 0,1 6.5,6.5M11.5,6.5A1,1 0 0,1 12.5,7.5A1,1 0 0,1 11.5,8.5A1,1 0 0,1 10.5,7.5A1,1 0 0,1 11.5,6.5M16,9C12.69,9 10,11.24 10,14C10,16.76 12.69,19 16,19C16.67,19 17.31,18.92 17.91,18.75L20,20L19.38,18.13C20.95,17.22 22,15.71 22,14C22,11.24 19.31,9 16,9M14,11.5A1,1 0 0,1 15,12.5A1,1 0 0,1 14,13.5A1,1 0 0,1 13,12.5A1,1 0 0,1 14,11.5M18,11.5A1,1 0 0,1 19,12.5A1,1 0 0,1 18,13.5A1,1 0 0,1 17,12.5A1,1 0 0,1 18,11.5Z"/>
    </svg>
    <span>微信登录</span>
</button>

<!-- 分隔线 -->
<div class="social-login-divider">
    <span>或使用邮箱登录</span>
</div>

<form hx-post="/auth/login"
      hx-target="#login-form-container"
      hx-swap="innerHTML"
      class="auth-form">
    <div class="form-group">
        <label class="form-label" for="email">邮箱</label>
        <input type="email"
               id="email"
               name="email"
               class="form-input"
               value="{{ email or '' }}"
               placeholder="请输入邮箱"
               required>
    </div>

    <div class="form-group">
        <label class="form-label" for="password">密码</label>
        <input type="password"
               id="password"
               name="password"
               class="form-input"
               placeholder="请输入密码"
               required>
    </div>

    <button type="submit" class="btn-primary btn-full">
        <span class="htmx-indicator">登录中...</span>
        <span class="btn-text">登录</span>
    </button>
</form>

<style>
/* 错误提示样式 */
.login-error {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 1.25rem;
    background: #fef2f2;
    border: 2px solid #f87171;
    border-radius: var(--border-radius);
    animation: shake 0.5s ease-in-out;
}

.login-error .error-icon {
    font-size: 1.25rem;
}

.login-error .error-text {
    font-weight: 500;
    color: #b91c1c;
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
    20%, 40%, 60%, 80% { transform: translateX(5px); }
}

.btn-full {
    width: 100%;
    padding: 0.75rem;
    font-size: 1rem;
}

.htmx-indicator {
    display: none;
}

.htmx-request .htmx-indicator {
    display: inline;
}

.htmx-request .btn-text {
    display: none;
}

/* 社交登录分隔线 */
.social-login-divider {
    display: flex;
    align-items: center;
    margin: 1.5rem 0;
}

.social-login-divider::before,
.social-login-divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border-color);
}

.social-login-divider span {
    padding: 0 1rem;
    color: var(--text-muted);
    font-size: 0.9rem;
}

/* 微信登录按钮 */
.btn-wechat {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    background: #07C160;
    color: white;
    border: none;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-wechat:hover {
    background: #06AE56;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(7, 193, 96, 0.3);
}

.btn-wechat:active {
    transform: translateY(0);
}

.wechat-icon {
    flex-shrink: 0;
}

/* 主推微信按钮样式 */
.btn-wechat-primary {
    padding: 1rem;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0;
    box-shadow: 0 4px 15px rgba(7, 193, 96, 0.4);
}

.btn-wechat-primary:hover {
    box-shadow: 0 6px 20px rgba(7, 193, 96, 0.5);
}
</style>

<script>
function wechatLogin() {
    // 跳转到微信授权页面
    window.location.href = '/auth/wechat/authorize?action=login';
}
</script>
